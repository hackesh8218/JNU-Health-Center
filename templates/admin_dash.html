<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard | JNU Health Centre</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Load Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    
    <style>
        /* Custom CSS for REALISTIC, ATTRACTIVE Buttons (Edit, Delete, Blacklist) */
        .btn-action {
            padding: 6px 14px; 
            font-weight: 700; 
            font-size: 0.75rem; 
            border-radius: 9999px; 
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2); 
            transition: all 200ms cubic-bezier(0.4, 0, 0.2, 1);
            transform: translateY(0);
            cursor: pointer;
            border: 1px solid transparent; 
        }

        .btn-action:hover {
            transform: translateY(-3px); 
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3); 
        }

        /* Specific Hover Styles for Realistic Colors/Borders */
        .bg-green-500:hover { border-color: #34D399; }
        .bg-red-500:hover { border-color: #F87171; }
        .bg-yellow-600:hover { border-color: #FBBF24; }
                .header-bg {
            background-image: linear-gradient(to right, #4CAF50, #2196F3);
            background-size: cover;
            background-position: center;
            height: 120px;
            display: flex;
            align-items: center;
            padding: 0 24px;
        }
        .header-logo {
            height: 80px;
            width: 80px;
            margin-right: 20px;
            border-radius: 50%; 
            object-fit: cover;
        }
        .header-text h1 {
            font-size: 2.5rem;
            font-weight: 700;
            color: #ffffff;
            margin-bottom: 0.25rem;
        }
        .header-text p {
            font-size: 1.1rem;
            color: #e0e0e0;
            font-weight: 500;
        }

    </style>
</head>
<body class="bg-gray-100 min-h-screen pb-12">

    <!-- 2. HEADER BAR (Gradient Admin Style) -->
    <header class="w-full bg-gradient-to-r from-teal-400 to-blue-500 shadow-xl">
      <div class="container mx-auto px-6 py-4 flex justify-end items-center space-x-8">
          <div class="container mx-auto flex items-center">
                <img src="/static/uploads/JNUlogo.jpeg" alt="JNU Logo" class="header-logo" />
                <div class="header-text">
                    <h1>JNU Health Centre</h1>
                    <p>Online Specialist Consultations & Part Time Psychology Services</p>
                </div>
            </div>
            
            <!-- Welcome Message -->
            <div class="flex items-center space-x-2">
                <span class="text-xl font-medium text-white shadow-text">Welcome, </span>
                <span class="text-xl font-extrabold text-blue-800 bg-white px-2 py-0.5 rounded-md shadow-lg">{{this_user.name}}</span>
            </div>
            
            <!-- NEW: Search Form with Dropdown Selector (FUNCTIONALIZED) -->
            <form class="flex items-center space-x-0" action="/search" method="GET">
                
                <!-- Hidden input to store selected search type -->
                <input type="hidden" name="search_type" id="search_type_input" value="Patient">

                <!-- Search Type Dropdown -->
                <div class="relative group" id="search-dropdown-container">
                    <button type="button" id="search-type-button" class="bg-white text-gray-700 px-3 py-2 border-2 border-r-0 border-orange-500 rounded-l-lg hover:bg-gray-100 transition duration-150 font-semibold text-sm shadow-md flex items-center space-x-1 focus:outline-none">
                        <span id="selected-search-text">Patient</span>
                        <i class="fas fa-chevron-down text-xs ml-1 transition-transform duration-300 group-hover:rotate-180"></i>
                    </button>
                    
                    <!-- Dropdown Content -->
                    <div id="dropdown-content" class="absolute left-0 mt-0 w-40 rounded-lg shadow-xl bg-white ring-1 ring-black ring-opacity-5 opacity-0 pointer-events-none group-hover:opacity-100 group-hover:pointer-events-auto transform scale-95 group-hover:scale-100 transition ease-out duration-200 origin-top z-30">
                        <div class="py-1">
                            <!-- Dropdown Link 1: Patient (Clicking enables patient search logic) -->
                            <a href="#" data-search-value="Patient" data-placeholder="Search Patient Name" class="search-option block px-4 py-2 text-sm text-gray-700 hover:bg-indigo-100 hover:text-indigo-900 transition duration-150 ease-in-out flex items-center space-x-2">
                                <i class="fas fa-user"></i> <span>Patient</span>
                            </a>
                            <!-- Dropdown Link 2: Doctor (Clicking enables doctor search logic) -->
                            <a href="#" data-search-value="Doctor" data-placeholder="Search Doctor Name" class="search-option block px-4 py-2 text-sm text-gray-700 hover:bg-indigo-100 hover:text-indigo-900 transition duration-150 ease-in-out flex items-center space-x-2">
                                <i class="fas fa-user-md"></i> <span>Doctor</span>
                            </a>
                            <!-- Dropdown Link 3: Department (Clicking enables department search logic) -->
                            <a href="#" data-search-value="Department" data-placeholder="Search Department Name" class="search-option block px-4 py-2 text-sm text-gray-700 hover:bg-indigo-100 hover:text-indigo-900 transition duration-150 ease-in-out flex items-center space-x-2">
                                <i class="fas fa-hospital-alt"></i> <span>Department</span>
                            </a>
                        </div>
                    </div>
                </div>

                <!-- Search Input and Button -->
                <input type="search" name="query" id="search-input-field" placeholder="Search Patient Name" aria-label="Search"
                        class="w-64 px-4 py-2 border-2 border-orange-500 focus:outline-none focus:ring-4 focus:ring-orange-300 focus:border-orange-600 transition duration-150 shadow-md text-gray-700">
                <button type="submit" class="bg-orange-600 text-white px-5 py-2 border-2 border-orange-600 rounded-r-lg hover:bg-orange-700 transition-colors duration-200 font-bold shadow-md">
                    <i class="fas fa-search"></i>
                </button>
            </form>

            <!-- Logout Button -->
            <a href="{{ url_for('logout') }}" class="text-white hover:text-red-300 transition-colors duration-200 flex items-center space-x-1 font-semibold text-lg">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
                </svg>
                <span>LogOut</span>
            </a>
        </div>
    </header>

    <!-- Main Content Area -->
    <div class="container mx-auto px-6 mt-8">

        <!-- NEW SECTION: QUICK CREATION ACTIONS -->
        <div class="bg-white p-6 rounded-xl shadow-xl mb-8 border-t-4 border-blue-500">
            <h3 class="text-2xl font-bold text-blue-800 mb-4">Quick Admin Actions</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                
                <!-- Add New Doctor -->
                <a href="{{ url_for('add_doctor') }}" class="flex items-center justify-center p-4 bg-green-500 text-white font-bold rounded-lg shadow-lg hover:bg-green-600 transition-colors duration-200 space-x-2 transform hover:scale-[1.02]">
                    <i class="fas fa-user-plus h-6 w-6"></i>
                    <span>Add New Doctor</span>
                </a>

                <!-- Add New Department -->
                <a href="{{ url_for('add_department') }}" class="flex items-center justify-center p-4 bg-purple-500 text-white font-bold rounded-lg shadow-lg hover:bg-purple-600 transition-colors duration-200 space-x-2 transform hover:scale-[1.02]">
                    <i class="fas fa-hospital-alt h-6 w-6"></i>
                    <span>Add New Dept.</span>
                </a>

                <!-- Example: View Pending Approvals -->
                <a href="#" class="flex items-center justify-center p-4 bg-orange-500 text-white font-bold rounded-lg shadow-lg hover:bg-orange-600 transition-colors duration-200 space-x-2 transform hover:scale-[1.02]">
                    <i class="fas fa-bell h-6 w-6"></i>
                    <span>View Approvals</span>
                </a>

            </div>
        </div>
        <!-- End Quick Actions -->

        <!-- 3. Dashboard Metrics Section -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-12">
            <!-- Card 1: Total Patients -->
            <div class="bg-white p-6 rounded-xl shadow-lg border-l-4 border-blue-600 flex items-center justify-between">
                <div>
                    <p class="text-sm font-medium text-gray-500">Total Registered Patients</p>
                    <p class="text-3xl font-bold text-blue-800 mt-1">{{ patient_count | default(0) }}</p>
                </div>
                <i class="fas fa-users text-4xl text-blue-500 opacity-30"></i>
            </div>
            
            <!-- Card 2: Total Doctors -->
            <div class="bg-white p-6 rounded-xl shadow-lg border-l-4 border-green-600 flex items-center justify-between">
                <div>
                    <p class="text-sm font-medium text-gray-500">Total Registered Doctors</p>
                    <p class="text-3xl font-bold text-green-800 mt-1">{{ doctor_count | default(0) }}</p>
                </div>
                <i class="fas fa-user-md text-4xl text-green-500 opacity-30"></i>
            </div>

            <!-- Card 3: Available Departments -->
            <div class="bg-white p-6 rounded-xl shadow-lg border-l-4 border-purple-600 flex items-center justify-between">
                <div>
                    <p class="text-sm font-medium text-gray-500">Available Departments</p>
                    <p class="text-3xl font-bold text-purple-800 mt-1">{{ department_count | default(8) }}</p>
                </div>
                <i class="fas fa-hospital text-4xl text-purple-500 opacity-30"></i>
            </div>

            <!-- Card 4: Upcoming Appointments -->
            <div class="bg-white p-6 rounded-xl shadow-lg border-l-4 border-orange-600 flex items-center justify-between">
                <div>
                    <p class="text-sm font-medium text-gray-500">Pending Appointments</p>
                    <p class="text-3xl font-bold text-orange-800 mt-1">{{ appointment_list | length }}</p>
                </div>
                <i class="fas fa-calendar-check text-4xl text-orange-500 opacity-30"></i>
            </div>
        </div>

        <!-- UPDATED SECTION: Department Management List (Jinja Loop) -->
        <div class="bg-white p-6 rounded-2xl shadow-2xl border-t-8 border-purple-600 mb-8">
            <h3 class="text-2xl font-extrabold text-blue-800 pb-1 border-b-4 border-orange-500 mb-6">
                <i class="fas fa-briefcase-medical mr-2 text-purple-600"></i>Department Management List
            </h3>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4">
                <!-- Expecting 'department_list_details' from the backend -->
                {% for dept in department_list_details %}
                <div class="bg-purple-50 p-4 rounded-lg shadow-md hover:shadow-lg transition duration-200 border-l-4 border-purple-400">
                    <p class="text-lg font-bold text-purple-800">{{ dept.name }}</p>
                    <p class="text-sm text-gray-700 mt-1">HOD: <span class="font-medium">{{ dept.head | default('N/A') }}</span></p>
                    <p class="text-sm text-gray-700">Status: 
                        <span class="font-bold {% if dept.status == 'Limited Capacity' %}text-red-500{% else %}text-green-600{% endif %}">
                            {{ dept.status | default('Operational') }}
                        </span>
                    </p>
                    <a href="/department/{{ dept.id }}" class="mt-2 inline-block text-sm font-bold text-purple-700 hover:text-purple-900 hover:underline">
                        View Details <i class="fas fa-arrow-right ml-1 text-xs"></i>
                    </a>
                </div>
                {% else %}
                <div class="col-span-full p-4 text-center text-gray-500 italic">No department details found.</div>
                {% endfor %}
            </div>
        </div>


        <!-- 4. Tables Section -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            
            <!-- Table 1: Registered Doctors -->
            <div class="bg-white p-6 rounded-2xl shadow-2xl border-t-8 border-blue-600 lg:col-span-1">
                <div class="flex justify-between items-center mb-6">
                    <h3 class="text-2xl font-extrabold text-blue-800 pb-1 border-b-4 border-orange-500">
                        <i class="fas fa-user-md mr-2 text-orange-500"></i>Registered Doctors ({{ doctor_count }})
                    </h3>
                </div>
                
                <div class="overflow-x-auto">
                    <table class="min-w-full divide-y divide-gray-300">
                        <thead class="bg-blue-50">
                            <tr>
                                <th scope="col" class="px-3 py-3 text-left text-xs font-semibold text-blue-800 uppercase tracking-wider">Sr. No.</th>
                                <th scope="col" class="px-3 py-3 text-left text-xs font-semibold text-blue-800 uppercase tracking-wider">Name</th>
                                <th scope="col" class="px-3 py-3 text-left text-xs font-semibold text-blue-800 uppercase tracking-wider">Department</th>
                                <th scope="col" class="px-3 py-3 text-left text-xs font-semibold text-blue-800 uppercase tracking-wider">Actions</th>
                            </tr>
                        </thead>
                        <tbody class="bg-white divide-y divide-gray-200">
                            {% for doctor in doctors_list %}
                            <tr class="{% if loop.index is divisibleby 2 %}bg-gray-50{% else %}bg-white{% endif %} hover:bg-indigo-50 transition-colors duration-150">
                                <td class="px-3 py-4 whitespace-nowrap text-sm font-bold text-gray-900">{{ loop.index }}</td>
                                <td class="px-3 py-4 whitespace-nowrap text-sm text-gray-700">{{ doctor.name }}</td>
                                <td class="px-3 py-4 whitespace-nowrap text-sm text-indigo-600 font-medium">{{ doctor.department | default('Cardiology') }}</td>
                                <td class="px-3 py-4 whitespace-nowrap text-sm font-medium space-x-2">
                                    <button class="btn-action bg-green-500 hover:bg-green-600">
                                        <i class="fas fa-edit mr-1"></i>Edit
                                    </button>
                                    <form action="#" method="POST" class="inline" onsubmit="return confirm('Are you sure you want to delete {{ doctor.name }}?');">
                                        <button type="submit" class="btn-action bg-red-500 hover:bg-red-600">
                                            <i class="fas fa-trash-alt mr-1"></i>Delete
                                        </button>
                                    </form>
                                    <button class="btn-action bg-yellow-600 hover:bg-yellow-700">
                                        <i class="fas fa-ban mr-1"></i>Blacklist
                                    </button>
                                </td>
                            </tr>
                            {% else %}
                            <tr>
                                <td colspan="4" class="px-3 py-4 text-center text-gray-500 italic">No doctors registered yet.</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Table 2: Registered Patients -->
            <div class="bg-white p-6 rounded-2xl shadow-2xl border-t-8 border-green-600 lg:col-span-1">
                <h3 class="text-2xl font-extrabold text-blue-800 mb-6 pb-1 border-b-4 border-orange-500">
                    <i class="fas fa-users mr-2 text-green-600"></i>Registered Patients ({{ patient_count }})
                </h3>
                <div class="overflow-x-auto">
                    <table class="min-w-full divide-y divide-gray-300">
                        <thead class="bg-blue-50">
                            <tr>
                                <th scope="col" class="px-3 py-3 text-left text-xs font-semibold text-blue-800 uppercase tracking-wider">Sr. No.</th>
                                <th scope="col" class="px-3 py-3 text-left text-xs font-semibold text-blue-800 uppercase tracking-wider">Name</th>
                                <th scope="col" class="px-3 py-3 text-left text-xs font-semibold text-blue-800 uppercase tracking-wider">Actions</th>
                            </tr>
                        </thead>
                        <tbody class="bg-white divide-y divide-gray-200">
                            {% for patient in patient_list %}
                            <tr class="{% if loop.index is divisibleby 2 %}bg-gray-50{% else %}bg-white{% endif %} hover:bg-indigo-50 transition-colors duration-150">
                                <td class="px-3 py-4 whitespace-nowrap text-sm font-bold text-gray-900">{{ loop.index }}</td>
                                <td class="px-3 py-4 whitespace-nowrap text-sm text-gray-700">{{ patient.name }}</td>
                                <td class="px-3 py-4 whitespace-nowrap text-sm font-medium space-x-2">
                                    <button class="btn-action bg-green-500 hover:bg-green-600">
                                        <i class="fas fa-edit mr-1"></i>Edit
                                    </button>
                                    <button class="btn-action bg-red-500 hover:bg-red-600">
                                        <i class="fas fa-trash-alt mr-1"></i>Delete
                                    </button>
                                    <button class="btn-action bg-yellow-600 hover:bg-yellow-700">
                                        <i class="fas fa-ban mr-1"></i>Blacklist
                                    </button>
                                </td>
                            </tr>
                            {% else %}
                            <tr>
                                <td colspan="3" class="px-3 py-4 text-center text-gray-500 italic">No patients registered yet.</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Image/Ad Placeholder (Updated Content) -->
            <div class="bg-white p-6 rounded-2xl shadow-2xl border-t-8 border-orange-500 flex flex-col justify-between items-center lg:col-span-1">
                <h3 class="text-xl font-extrabold text-blue-800 mb-4">Hospital Spotlight: Digital Transformation</h3>
                <img src="https://placehold.co/400x250/F97316/FFFFFF?text=EHR+Integration" alt="Hospital Facility Image" class="rounded-lg shadow-xl w-full object-cover">
                <p class="mt-4 text-center text-gray-700 text-sm">
                    JNU Health Centre is moving to a fully integrated Electronic Health Records (EHR) system. This will streamline patient data access, improve diagnostic speed, and enhance cross-departmental collaboration for better care continuity.
                </p>
                <a href="#" class="mt-4 text-sm font-bold text-orange-600 hover:text-orange-700">Learn More About EHR <i class="fas fa-chevron-right ml-1 text-xs"></i></a>
            </div>
            
        </div>

        <!-- NEW: Table 4: Treated Patient Records (Updated Lab Report Button) -->
        <div class="bg-white p-6 rounded-2xl shadow-2xl border-t-8 border-red-600 mt-8">
            <h3 class="text-2xl font-extrabold text-blue-800 pb-1 border-b-4 border-orange-500 mb-6">
                <i class="fas fa-notes-medical mr-2 text-red-600"></i>Treated Patient Records
            </h3>
            <div class="overflow-x-auto">
                <table class="min-w-full divide-y divide-gray-300">
                    <thead class="bg-blue-50">
                        <tr>
                            <th scope="col" class="px-3 py-3 text-left text-xs font-semibold text-blue-800 uppercase tracking-wider">Record ID</th>
                            <th scope="col" class="px-3 py-3 text-left text-xs font-semibold text-blue-800 uppercase tracking-wider">Patient Name</th>
                            <th scope="col" class="px-3 py-3 text-left text-xs font-semibold text-blue-800 uppercase tracking-wider">Treated By (Doctor)</th>
                            <th scope="col" class="px-3 py-3 text-left text-xs font-semibold text-blue-800 uppercase tracking-wider">Last Visit Date</th>
                            <th scope="col" class="px-3 py-3 text-left text-xs font-semibold text-blue-800 uppercase tracking-wider">Patient History</th>
                            <th scope="col" class="px-3 py-3 text-left text-xs font-semibold text-blue-800 uppercase tracking-wider">Lab Report</th>
                            <th scope="col" class="px-3 py-3 text-left text-xs font-semibold text-blue-800 uppercase tracking-wider">Actions</th>
                        </tr>
                    </thead>
                    <tbody class="bg-white divide-y divide-gray-200">
                        <!-- Mock data for Treated Patients -->
                        {% set treated_patients = [
                            {'id': 'TRK1001', 'name': 'Rajesh Gupta', 'doctor': 'Dr. P. Kumar', 'date': '2023-10-15', 'history_link': '/history/1', 'lab_link': '/lab/1'},
                            {'id': 'TRK1002', 'name': 'Anjali Varma', 'doctor': 'Dr. A. Singh', 'date': '2023-11-01', 'history_link': '/history/2', 'lab_link': '/lab/2'}
                        ] %}
                        {% for record in treated_patients %}
                        <tr class="{% if loop.index is divisibleby 2 %}bg-gray-50{% else %}bg-white{% endif %} hover:bg-indigo-50 transition-colors duration-150">
                            <td class="px-3 py-4 whitespace-nowrap text-sm font-bold text-gray-900">{{ record.id }}</td>
                            <td class="px-3 py-4 whitespace-nowrap text-sm text-gray-700">{{ record.name }}</td>
                            <td class="px-3 py-4 whitespace-nowrap text-sm text-gray-700">{{ record.doctor }}</td>
                            <td class="px-3 py-4 whitespace-nowrap text-sm text-gray-700">{{ record.date }}</td>
                            <td class="px-3 py-4 whitespace-nowrap text-sm font-medium">
                                <!-- STYLING UPDATE: Patient History Button -->
                                <a href="{{ record.history_link }}" class="inline-block group">
                                    <button class="bg-blue-600 hover:bg-blue-700 text-white font-bold px-3 py-1.5 text-xs rounded-lg shadow-md transition duration-150 ease-in-out transform hover:scale-105 flex items-center space-x-1">
                                        <i class="fas fa-notes-medical mr-1"></i>
                                        <span>View History</span>
                                    </button>
                                </a>
                            </td>
                            <td class="px-3 py-4 whitespace-nowrap text-sm font-medium">
                                <!-- Show Lab Report Button -->
                                <a href="{{ record.lab_link }}" class="inline-block group">
                                    <button class="bg-orange-500 hover:bg-orange-600 text-white font-bold px-3 py-1.5 text-xs rounded-lg shadow-md transition duration-150 ease-in-out transform hover:scale-105 flex items-center space-x-1">
                                        <i class="fas fa-file-medical mr-1"></i>
                                        <span>Show Lab Report</span>
                                    </button>
                                </a>
                            </td>
                            <td class="px-3 py-4 whitespace-nowrap text-sm font-medium space-x-2">
                                <button class="btn-action bg-green-500 hover:bg-green-600">
                                    <i class="fas fa-edit mr-1"></i>Edit
                                </button>
                                <button class="btn-action bg-red-500 hover:bg-red-600">
                                    <i class="fas fa-trash-alt mr-1"></i>Delete
                                </button>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Table 3: Upcoming Appointments (Full Width - Removed View History button) -->
        <div class="bg-white p-6 rounded-2xl shadow-2xl border-t-8 border-indigo-600 mt-8">
            <h3 class="text-2xl font-extrabold text-blue-800 pb-1 border-b-4 border-orange-500 mb-6">
                <i class="fas fa-calendar-check mr-2 text-indigo-600"></i>Upcoming Appointments ({{ appointment_list | length }})
            </h3>
            <div class="overflow-x-auto">
                <table class="min-w-full divide-y divide-gray-300">
                    <thead class="bg-blue-50">
                        <tr>
                            <th scope="col" class="px-3 py-3 text-left text-xs font-semibold text-blue-800 uppercase tracking-wider">Appt. ID</th>
                            <th scope="col" class="px-3 py-3 text-left text-xs font-semibold text-blue-800 uppercase tracking-wider">Patient Name</th>
                            <th scope="col" class="px-3 py-3 text-left text-xs font-semibold text-blue-800 uppercase tracking-wider">Doctor Name</th>
                            <th scope="col" class="px-3 py-3 text-left text-xs font-semibold text-blue-800 uppercase tracking-wider">Department</th>
                            <th scope="col" class="px-3 py-3 text-left text-xs font-semibold text-blue-800 uppercase tracking-wider">Actions</th>
                        </tr>
                    </thead>
                    <tbody class="bg-white divide-y divide-gray-200">
                        {% for appt_data in appointment_list %}
                        <tr class="{% if loop.index is divisibleby 2 %}bg-gray-50{% else %}bg-white{% endif %} hover:bg-indigo-50 transition-colors duration-150">
                            <td class="px-3 py-4 whitespace-nowrap text-sm font-bold text-gray-900">{{ appt_data.Appointment.appointment_id }}</td>
                            <td class="px-3 py-4 whitespace-nowrap text-sm text-gray-700">{{ appt_data.patient_name }}</td>
                            <td class="px-3 py-4 whitespace-nowrap text-sm text-gray-700">{{ appt_data.doctor_name }}</td>
                            <td class="px-3 py-4 whitespace-nowrap text-sm text-gray-700">{{ appt_data.dept_name }}</td>
                            <td class="px-3 py-4 whitespace-nowrap text-sm font-medium space-x-2">
                                
                                <!-- Edit Button -->
                                <button class="btn-action bg-green-500 hover:bg-green-600">
                                    <i class="fas fa-edit mr-1"></i>Edit
                                </button>
                                
                                <!-- Delete Button -->
                                <form action="#" method="POST" class="inline" onsubmit="return confirm('Are you sure you want to delete appointment {{ appt_data.Appointment.appointment_id }}?');">
                                    <button type="submit" class="btn-action bg-red-500 hover:bg-red-600">
                                        <i class="fas fa-trash-alt mr-1"></i>Delete
                                    </button>
                                </form>

                            </td>
                        </tr>
                        {% else %}
                        <tr>
                            <td colspan="5" class="px-3 py-4 text-center text-gray-500 italic">No upcoming appointments found.</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div> 

    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const searchDropdownContainer = document.getElementById('search-dropdown-container');
            const searchTypeButton = document.getElementById('search-type-button');
            const selectedSearchText = document.getElementById('selected-search-text');
            const searchTypeInput = document.getElementById('search_type_input');
            const searchInputField = document.getElementById('search-input-field');
            const searchOptions = document.querySelectorAll('.search-option');
            const dropdownContent = document.getElementById('dropdown-content');

            // Set initial state
            selectedSearchText.textContent = searchTypeInput.value;
            searchInputField.placeholder = "Search " + searchTypeInput.value + " Name";

            // Toggle dropdown visibility on button click (fallback for non-hover interaction)
            searchTypeButton.addEventListener('click', (e) => {
                e.preventDefault();
                dropdownContent.classList.toggle('opacity-0');
                dropdownContent.classList.toggle('pointer-events-none');
                dropdownContent.classList.toggle('scale-95');
                dropdownContent.classList.toggle('opacity-100');
                dropdownContent.classList.toggle('scale-100');
            });

            // Handle selection of a search type
            searchOptions.forEach(option => {
                option.addEventListener('click', (e) => {
                    e.preventDefault();
                    
                    const value = option.getAttribute('data-search-value');
                    const placeholder = option.getAttribute('data-placeholder');
                    
                    // Update form values
                    selectedSearchText.textContent = value;
                    searchTypeInput.value = value;
                    searchInputField.placeholder = placeholder;
                    
                    // Close dropdown manually (in case it was opened by click)
                    dropdownContent.classList.add('opacity-0', 'pointer-events-none', 'scale-95');
                    dropdownContent.classList.remove('opacity-100', 'scale-100');
                    
                    // Optional: You can navigate here if the requirement was to navigate immediately,
                    // but since this is a search bar, updating the form values is correct.
                    // For example: if (value === 'Department') { window.location.href = '/avail-department'; }
                });
            });

            // Close dropdown when clicking outside
            document.addEventListener('click', (e) => {
                if (!searchDropdownContainer.contains(e.target)) {
                    dropdownContent.classList.add('opacity-0', 'pointer-events-none', 'scale-95');
                    dropdownContent.classList.remove('opacity-100', 'scale-100');
                }
            });
        });
    </script>
</body>
</html>